<svg viewBox="0 0 1400 1000" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1400" height="1000" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#2c3e50">
    Trusted Computing Base (TCB) Root of Trust Architecture
  </text>
  
  <!-- GCP Section -->
  <g transform="translate(50, 70)">
    <!-- GCP Header -->
    <rect x="0" y="0" width="600" height="40" fill="#4285f4" rx="5"/>
    <text x="300" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white">
      Google Cloud Platform (GCP)
    </text>
    
    <!-- Hardware Layer -->
    <rect x="0" y="50" width="600" height="80" fill="#e8f0fe" stroke="#4285f4" stroke-width="2" rx="5"/>
    <text x="10" y="70" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1a73e8">
      Hardware Root of Trust
    </text>
    <text x="20" y="90" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • AMD SEV-SNP Processor
    </text>
    <text x="20" y="105" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Hardware Security Module (HSM)
    </text>
    <text x="20" y="120" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • CPU Microcode &amp; Firmware
    </text>
    
    <!-- Firmware Layer -->
    <rect x="0" y="140" width="600" height="80" fill="#fce8e6" stroke="#ea4335" stroke-width="2" rx="5"/>
    <text x="10" y="160" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#ea4335">
      Firmware Layer (SRTM)
    </text>
    <text x="20" y="180" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • UEFI/OVMF Firmware
    </text>
    <text x="20" y="195" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Secure Boot Chain
    </text>
    <text x="20" y="210" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • PCR 0-7 Measurements
    </text>
    
    <!-- vTPM Layer -->
    <rect x="0" y="230" width="290" height="80" fill="#e6f4ea" stroke="#34a853" stroke-width="2" rx="5"/>
    <text x="10" y="250" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#34a853">
      vTPM Components
    </text>
    <text x="20" y="270" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • PCR Extend Operations
    </text>
    <text x="20" y="285" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Attestation Key (AK)
    </text>
    <text x="20" y="300" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Event Log Generation
    </text>
    
    <!-- SEV-SNP Layer -->
    <rect x="310" y="230" width="290" height="80" fill="#fef7e0" stroke="#fbbc04" stroke-width="2" rx="5"/>
    <text x="320" y="250" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#f9ab00">
      SEV-SNP Attestation
    </text>
    <text x="330" y="270" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Guest Memory Hash
    </text>
    <text x="330" y="285" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Platform Measurements
    </text>
    <text x="330" y="300" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Security Version Numbers
    </text>
    
    <!-- OS Layer -->
    <rect x="0" y="320" width="600" height="80" fill="#f3e8ff" stroke="#9c27b0" stroke-width="2" rx="5"/>
    <text x="10" y="340" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#9c27b0">
      Operating System Trust
    </text>
    <text x="20" y="360" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Linux IMA Measurements (PCR 10)
    </text>
    <text x="20" y="375" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Kernel &amp; Initramfs Integrity
    </text>
    <text x="20" y="390" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • File System Measurements
    </text>
    
    <!-- Verification -->
    <rect x="0" y="410" width="600" height="80" fill="#e1f5fe" stroke="#00bcd4" stroke-width="2" rx="5"/>
    <text x="10" y="430" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#00bcd4">
      Direct Verification Model
    </text>
    <text x="20" y="450" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • TCB Integrity Bucket (gce_tcb_integrity)
    </text>
    <text x="20" y="465" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Golden Measurements Comparison
    </text>
    <text x="20" y="480" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Independent Policy Verification
    </text>
  </g>
  
  <!-- Azure Section -->
  <g transform="translate(700, 70)">
    <!-- Azure Header -->
    <rect x="0" y="0" width="600" height="40" fill="#0078d4" rx="5"/>
    <text x="300" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white">
      Microsoft Azure
    </text>
    
    <!-- Hardware Layer -->
    <rect x="0" y="50" width="600" height="80" fill="#e1f5fe" stroke="#0078d4" stroke-width="2" rx="5"/>
    <text x="10" y="70" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#0078d4">
      Hardware Root of Trust
    </text>
    <text x="20" y="90" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • AMD SEV-SNP Processor
    </text>
    <text x="20" y="105" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Azure Hardware Security Module
    </text>
    <text x="20" y="120" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Platform Security Processor (PSP)
    </text>
    
    <!-- Firmware Layer -->
    <rect x="0" y="140" width="600" height="80" fill="#fff4e6" stroke="#ff8c00" stroke-width="2" rx="5"/>
    <text x="10" y="160" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#ff8c00">
      Firmware Layer (SRTM)
    </text>
    <text x="20" y="180" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • UEFI Firmware
    </text>
    <text x="20" y="195" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Secure Boot Validation
    </text>
    <text x="20" y="210" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Boot Component Measurements
    </text>
    
    <!-- vTPM Layer -->
    <rect x="0" y="230" width="290" height="80" fill="#e8f5e8" stroke="#28a745" stroke-width="2" rx="5"/>
    <text x="10" y="250" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#28a745">
      vTPM Components
    </text>
    <text x="20" y="270" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • PCR Values (0-23)
    </text>
    <text x="20" y="285" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • TPM Quote Generation
    </text>
    <text x="20" y="300" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Endorsement Keys
    </text>
    
    <!-- SEV-SNP Layer -->
    <rect x="310" y="230" width="290" height="80" fill="#fff3cd" stroke="#ffc107" stroke-width="2" rx="5"/>
    <text x="320" y="250" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#856404">
      SEV-SNP Attestation
    </text>
    <text x="330" y="270" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Launch Measurement
    </text>
    <text x="330" y="285" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Family ID &amp; Image ID
    </text>
    <text x="330" y="300" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • TCB Security Versions
    </text>
    
    <!-- OS Layer -->
    <rect x="0" y="320" width="600" height="80" fill="#f8f9fa" stroke="#6c757d" stroke-width="2" rx="5"/>
    <text x="10" y="340" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#6c757d">
      Operating System Trust
    </text>
    <text x="20" y="360" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Boot Configuration Data (BCD)
    </text>
    <text x="20" y="375" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • OS Loader Measurements
    </text>
    <text x="20" y="390" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Runtime Security State
    </text>
    
    <!-- MAA Service -->
    <rect x="0" y="410" width="600" height="80" fill="#e7f3ff" stroke="#0066cc" stroke-width="2" rx="5"/>
    <text x="10" y="430" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#0066cc">
      Microsoft Azure Attestation (MAA)
    </text>
    <text x="20" y="450" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • Centralized Attestation Service
    </text>
    <text x="20" y="465" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • JWT Token with Security Claims
    </text>
    <text x="20" y="480" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      • x-ms-isolation-tee Namespace
    </text>
  </g>
  
  <!-- Trust Chain Arrows -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
  
  <!-- GCP Trust Chain -->
  <g stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)">
    <line x1="150" y1="200" x2="150" y2="230"/>
    <line x1="250" y1="280" x2="250" y2="320"/>
    <line x1="350" y1="380" x2="350" y2="410"/>
  </g>
  
  <!-- Azure Trust Chain -->
  <g stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)">
    <line x1="850" y1="200" x2="850" y2="230"/>
    <line x1="950" y1="280" x2="950" y2="320"/>
    <line x1="1050" y1="380" x2="1050" y2="410"/>
  </g>
  
  <!-- Comparison Section -->
  <g transform="translate(50, 600)">
    <rect x="0" y="0" width="1250" height="300" fill="#f8f9fa" stroke="#dee2e6" stroke-width="2" rx="10"/>
    <text x="625" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#2c3e50">
      Key Differences in Trust Architecture
    </text>
    
    <!-- GCP Column -->
    <g transform="translate(50, 50)">
      <text x="250" y="0" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#4285f4">
        GCP Direct Verification
      </text>
      <text x="20" y="25" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ Direct access to golden measurements
      </text>
      <text x="20" y="45" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ Independent verification without centralized service
      </text>
      <text x="20" y="65" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ TCB Integrity Bucket for launch endorsements
      </text>
      <text x="20" y="85" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ Client-side policy enforcement
      </text>
      <text x="20" y="105" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ Event log replay for PCR verification
      </text>
      <text x="20" y="125" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ Protocol buffer serialized launch endorsements
      </text>
      <text x="20" y="145" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ teeNonce and vTpmNonce for freshness
      </text>
      <text x="20" y="165" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ Direct SEV-SNP report generation
      </text>
    </g>
    
    <!-- Azure Column -->
    <g transform="translate(650, 50)">
      <text x="250" y="0" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#0078d4">
        Azure Centralized Attestation
      </text>
      <text x="20" y="25" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ Microsoft Azure Attestation (MAA) service
      </text>
      <text x="20" y="45" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ Signed JWT tokens with security claims
      </text>
      <text x="20" y="65" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ x-ms-isolation-tee namespace claims
      </text>
      <text x="20" y="85" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ Centralized trust validation
      </text>
      <text x="20" y="105" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ Combined SEV-SNP + vTPM attestation
      </text>
      <text x="20" y="125" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ Hardware identity claims (familyId, imageId)
      </text>
      <text x="20" y="145" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ Security version number validation
      </text>
      <text x="20" y="165" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        ✓ MAA public key set verification
      </text>
    </g>
    
    <!-- Common Elements -->
    <g transform="translate(300, 230)">
      <text x="300" y="0" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#28a745">
        Common TCB Elements
      </text>
      <text x="20" y="25" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        • AMD SEV-SNP processor as hardware root of trust
      </text>
      <text x="20" y="40" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        • UEFI firmware as Static Root of Trust for Measurement (SRTM)
      </text>
      <text x="20" y="55" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
        • Virtual TPM for boot measurements and PCR extension
      </text>
    </g>
  </g>
  
  <!-- Legend -->
  <g transform="translate(50, 920)">
    <text x="0" y="0" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
      Trust Chain Flow:
    </text>
    <text x="120" y="0" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      Hardware Root → Firmware SRTM → vTPM/SEV-SNP → OS Trust → Verification
    </text>
    <text x="0" y="20" font-family="Arial, sans-serif" font-size="12" fill="#5f6368">
      Each layer extends trust to the next, creating an immutable chain of attestation evidence
    </text>
  </g>
</svg>
